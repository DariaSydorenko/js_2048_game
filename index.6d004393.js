var t,i,e,a,s,n,l,r;t=new(function(){var t;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];(function(t,i){if(!(t instanceof i))throw TypeError("Cannot call a class as a function")})(this,i),this.initialState=t,this.status="idle",this.score=0}return t=[{key:"moveLeft",value:function(){for(var t=JSON.parse(JSON.stringify(this.initialState)),i=0;i<this.initialState.length;i++)for(var e=1;e<this.initialState.length;e++)if(0!==this.initialState[i][e])for(var a=this.initialState[i][e],s=e-1;s>=0;s--){if(a===this.initialState[i][s]){this.initialState[i][e]=0,this.initialState[i][s]=2*a,this.score+=2*a;break}if(0!==this.initialState[i][s]){this.initialState[i][e]=0,this.initialState[i][s+1]=a;break}0===s&&(this.initialState[i][e]=0,this.initialState[i][s]=a)}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}},{key:"moveRight",value:function(){for(var t=JSON.parse(JSON.stringify(this.initialState)),i=0;i<this.initialState.length;i++)for(var e=this.initialState.length-2;e>=0;e--)if(0!==this.initialState[i][e])for(var a=this.initialState[i][e],s=e+1;s<this.initialState.length;s++){if(a===this.initialState[i][s]){this.initialState[i][e]=0,this.initialState[i][s]=2*a,this.score+=2*a;break}if(0!==this.initialState[i][s]){this.initialState[i][e]=0,this.initialState[i][s-1]=a;break}s===this.initialState.length-1&&(this.initialState[i][e]=0,this.initialState[i][s]=a)}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}},{key:"moveUp",value:function(){for(var t=JSON.parse(JSON.stringify(this.initialState)),i=0;i<this.initialState.length;i++)for(var e=1;e<this.initialState.length;e++)if(0!==this.initialState[e][i])for(var a=this.initialState[e][i],s=e-1;s>=0;s--){if(a===this.initialState[s][i]){this.initialState[e][i]=0,this.initialState[s][i]=2*a,this.score+=2*a;break}if(0!==this.initialState[s][i]){this.initialState[e][i]=0,this.initialState[s+1][i]=a;break}0===s&&(this.initialState[e][i]=0,this.initialState[s][i]=a)}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}},{key:"moveDown",value:function(){for(var t=JSON.parse(JSON.stringify(this.initialState)),i=0;i<this.initialState.length;i++)for(var e=this.initialState.length-2;e>=0;e--)if(0!==this.initialState[e][i])for(var a=this.initialState[e][i],s=e+1;s<this.initialState.length;s++){if(a===this.initialState[s][i]){this.initialState[e][i]=0,this.initialState[s][i]=2*a,this.score+=2*a;break}if(0!==this.initialState[s][i]){this.initialState[e][i]=0,this.initialState[s-1][i]=a;break}s===this.initialState.length-1&&(this.initialState[e][i]=0,this.initialState[s][i]=a)}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.initialState}},{key:"getStatus",value:function(){if("playing"===this.status){if(this.hasValue(2048))return this.status="win",this.status;if(!this.hasValue(0)){for(var t=0;t<this.initialState.length;t++)for(var i=0;i<this.initialState[t].length;i++){var e=t<this.initialState.length-2?this.initialState[t+1][i]:null,a=t>=1?this.initialState[t-1][i]:null,s=i<this.initialState.length-2?this.initialState[t][i+1]:null,n=i>=1?this.initialState[t][i-1]:null;if(this.initialState[t][i]===e||this.initialState[t][i]===a||this.initialState[t][i]===s||this.initialState[t][i]===n)return this.status}this.status="lose"}}return this.status}},{key:"start",value:function(){if(this.status="playing",this.initialState.every(function(t){return t.every(function(t){return 0===t})}))for(var t=0;t<=1;t++)this.hasValue(0)&&this.generateTwoOrFour()}},{key:"restart",value:function(){this.status="idle",this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0}},{key:"generateTwoOrFour",value:function(){var t=Math.floor(Math.random()*this.initialState.length),i=Math.floor(Math.random()*this.initialState[0].length);0===this.initialState[t][i]?this.initialState[t][i]=.9>Math.random()?2:4:this.generateTwoOrFour()}},{key:"colorCells",value:function(t){for(var i=0;i<this.initialState.length;i++)for(var e=t.rows[i],a=0;a<this.initialState[0].length;a++){var s=e.cells[a];s.className=s.className.split(" ").filter(function(t){return!t.startsWith("field-cell--")}).join(" "),0!==this.initialState[i][a]?(s.classList.add("field-cell--".concat(this.initialState[i][a])),s.textContent="".concat(this.initialState[i][a])):s.textContent=""}}},{key:"hasValue",value:function(t){for(var i=0;i<this.initialState.length;i++)for(var e=0;e<this.initialState[i].length;e++)if(this.initialState[i][e]===t)return!0;return!1}}],function(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(i.prototype,t),i}()),i=document.querySelector(".page"),e=document.querySelector(".button"),a=document.querySelector(".message-start"),s=document.querySelector(".game-field"),n=document.querySelector(".game-score"),l=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),e.addEventListener("click",function(i){i.preventDefault(),e.classList.contains("start")?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",a.classList.add("hidden"),t.start(),t.colorCells(s)):(l.classList.contains("hidden")||l.classList.add("hidden"),r.classList.contains("hidden")||r.classList.add("hidden"),e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),a.classList.remove("hidden"),t.restart(),t.colorCells(s),n.textContent=t.getScore()),e.blur()}),i.addEventListener("keydown",function(i){i.key.startsWith("Arrow")&&!1===i.repeat&&(i.preventDefault(),"playing"===t.getStatus()&&("ArrowRight"===i.key?t.moveRight():"ArrowLeft"===i.key?t.moveLeft():"ArrowUp"===i.key?t.moveUp():"ArrowDown"===i.key&&t.moveDown(),t.colorCells(s),n.textContent=t.getScore(),"win"===t.getStatus()&&l.classList.remove("hidden"),"lose"===t.getStatus()&&r.classList.remove("hidden")))});
//# sourceMappingURL=index.6d004393.js.map
