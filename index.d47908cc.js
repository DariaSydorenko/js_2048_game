const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.status="idle",this.score=0}moveLeft(){let t=JSON.parse(JSON.stringify(this.initialState));for(let t=0;t<this.initialState.length;t++)for(let i=1;i<this.initialState.length;i++)if(0!==this.initialState[t][i]){let e=this.initialState[t][i];for(let a=i-1;a>=0;a--){if(e===this.initialState[t][a]){this.initialState[t][i]=0,this.initialState[t][a]=2*e,this.score+=2*e;break}if(0!==this.initialState[t][a]){this.initialState[t][i]=0,this.initialState[t][a+1]=e;break}0===a&&(this.initialState[t][i]=0,this.initialState[t][a]=e)}}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}moveRight(){let t=JSON.parse(JSON.stringify(this.initialState));for(let t=0;t<this.initialState.length;t++)for(let i=this.initialState.length-2;i>=0;i--)if(0!==this.initialState[t][i]){let e=this.initialState[t][i];for(let a=i+1;a<this.initialState.length;a++){if(e===this.initialState[t][a]){this.initialState[t][i]=0,this.initialState[t][a]=2*e,this.score+=2*e;break}if(0!==this.initialState[t][a]){this.initialState[t][i]=0,this.initialState[t][a-1]=e;break}a===this.initialState.length-1&&(this.initialState[t][i]=0,this.initialState[t][a]=e)}}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}moveUp(){let t=JSON.parse(JSON.stringify(this.initialState));for(let t=0;t<this.initialState.length;t++)for(let i=1;i<this.initialState.length;i++)if(0!==this.initialState[i][t]){let e=this.initialState[i][t];for(let a=i-1;a>=0;a--){if(e===this.initialState[a][t]){this.initialState[i][t]=0,this.initialState[a][t]=2*e,this.score+=2*e;break}if(0!==this.initialState[a][t]){this.initialState[i][t]=0,this.initialState[a+1][t]=e;break}0===a&&(this.initialState[i][t]=0,this.initialState[a][t]=e)}}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}moveDown(){let t=JSON.parse(JSON.stringify(this.initialState));for(let t=0;t<this.initialState.length;t++)for(let i=this.initialState.length-2;i>=0;i--)if(0!==this.initialState[i][t]){let e=this.initialState[i][t];for(let a=i+1;a<this.initialState.length;a++){if(e===this.initialState[a][t]){this.initialState[i][t]=0,this.initialState[a][t]=2*e,this.score+=2*e;break}if(0!==this.initialState[a][t]){this.initialState[i][t]=0,this.initialState[a-1][t]=e;break}a===this.initialState.length-1&&(this.initialState[i][t]=0,this.initialState[a][t]=e)}}JSON.stringify(t)!==JSON.stringify(this.initialState)&&this.hasValue(0)&&this.generateTwoOrFour()}getScore(){return this.score}getState(){return this.initialState}getStatus(){if("playing"===this.status){if(this.hasValue(2048))return this.status="win",this.status;if(!this.hasValue(0)){for(let t=0;t<this.initialState.length;t++)for(let i=0;i<this.initialState[t].length;i++){let e=t<this.initialState.length-2?this.initialState[t+1][i]:null,a=t>=1?this.initialState[t-1][i]:null,s=i<this.initialState.length-2?this.initialState[t][i+1]:null,l=i>=1?this.initialState[t][i-1]:null;if(this.initialState[t][i]===e||this.initialState[t][i]===a||this.initialState[t][i]===s||this.initialState[t][i]===l)return this.status}this.status="lose"}}return this.status}start(){if(this.status="playing",this.initialState.every(t=>t.every(t=>0===t)))for(let t=0;t<=1;t++)this.hasValue(0)&&this.generateTwoOrFour()}restart(){this.status="idle",this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0}generateTwoOrFour(){let t=Math.floor(Math.random()*this.initialState.length),i=Math.floor(Math.random()*this.initialState[0].length);0===this.initialState[t][i]?this.initialState[t][i]=.9>Math.random()?2:4:this.generateTwoOrFour()}colorCells(t){for(let i=0;i<this.initialState.length;i++){let e=t.rows[i];for(let t=0;t<this.initialState[0].length;t++){let a=e.cells[t];a.className=a.className.split(" ").filter(t=>!t.startsWith("field-cell--")).join(" "),0!==this.initialState[i][t]?(a.classList.add(`field-cell--${this.initialState[i][t]}`),a.textContent=`${this.initialState[i][t]}`):a.textContent=""}}}hasValue(t){for(let i=0;i<this.initialState.length;i++)for(let e=0;e<this.initialState[i].length;e++)if(this.initialState[i][e]===t)return!0;return!1}},i=document.querySelector(".page"),e=document.querySelector(".button"),a=document.querySelector(".message-start"),s=document.querySelector(".game-field"),l=document.querySelector(".game-score"),n=document.querySelector(".message-win"),h=document.querySelector(".message-lose");e.addEventListener("click",i=>{i.preventDefault(),e.classList.contains("start")?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",a.classList.add("hidden"),t.start(),t.colorCells(s)):(n.classList.contains("hidden")||n.classList.add("hidden"),h.classList.contains("hidden")||h.classList.add("hidden"),e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),a.classList.remove("hidden"),t.restart(),t.colorCells(s),l.textContent=t.getScore()),e.blur()}),i.addEventListener("keydown",i=>{i.key.startsWith("Arrow")&&!1===i.repeat&&(i.preventDefault(),"playing"===t.getStatus()&&("ArrowRight"===i.key?t.moveRight():"ArrowLeft"===i.key?t.moveLeft():"ArrowUp"===i.key?t.moveUp():"ArrowDown"===i.key&&t.moveDown(),t.colorCells(s),l.textContent=t.getScore(),"win"===t.getStatus()&&n.classList.remove("hidden"),"lose"===t.getStatus()&&h.classList.remove("hidden")))});
//# sourceMappingURL=index.d47908cc.js.map
